# üìò –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ OPC DA (Classic)

## –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
**OPC DA (Data Access)** ‚Äî —ç—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –æ–±–º–µ–Ω–∞ –¥–∞–Ω–Ω—ã–º–∏ –≤ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ Microsoft DCOM. –í —Å–∏—Å—Ç–µ–º–µ **Faceplate** –¥–∞–Ω–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –ª—é–±—ã–º –≤–Ω–µ—à–Ω–∏–º OPC-—Å–µ—Ä–≤–µ—Ä–∞–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, Kepware, Matrikon, Lectus) –∏ —Å—á–∏—Ç—ã–≤–∞—Ç—å —Å –Ω–∏—Ö –¥–∞–Ω–Ω—ã–µ.

> **–í–∞–∂–Ω–æ:** –ü–æ—Å–∫–æ–ª—å–∫—É OPC DA –±–∞–∑–∏—Ä—É–µ—Ç—Å—è –Ω–∞ DCOM, –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —á–∞—Å—Ç–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ Windows –∏ DCOM –Ω–∞ –æ–±–µ–∏—Ö —Å—Ç–æ—Ä–æ–Ω–∞—Ö (–ö–ª–∏–µ–Ω—Ç –∏ –°–µ—Ä–≤–µ—Ä).

–ü—Ä–æ—Ü–µ—Å—Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö —ç—Ç–∞–ø–æ–≤:
1.  **Connection (`plc_opcda_connection`):** –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ OPC-—Å–µ—Ä–≤–µ—Ä—É.
2.  **Binding (`plc_opcda_binding`):** –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ–≥–∏.

---

## –®–ê–ì 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (Connection)

–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ –º—ã —É–∫–∞–∑—ã–≤–∞–µ–º, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è OPC-—Å–µ—Ä–≤–µ—Ä –∏ –∫–∞–∫ –æ–Ω –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è.

### 1.1 –ü–∞–Ω–µ–ª—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ (Runtime)
*–í–µ—Ä—Ö–Ω—è—è —á–∞—Å—Ç—å –æ–∫–Ω–∞. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.*

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| **State** | **STOP** (–ö—Ä–∞—Å–Ω—ã–π) ‚Äî –¥—Ä–∞–π–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω.<br>**RUN** (–ó–µ–ª–µ–Ω—ã–π) ‚Äî —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ. |
| **Error** | –¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏. –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏: `Access Denied` (–ø—Ä–æ–±–ª–µ–º—ã DCOM) –∏–ª–∏ `Server not found`. |
| **Actual connection** | –¢–µ–∫—É—â–∏–π –∞–∫—Ç–∏–≤–Ω—ã–π –∫–∞–Ω–∞–ª (–ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è). |

### 1.2 –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (Settings)

![–ù–∞—Å—Ç—Ä–æ–π–∫–∞ OPC DA Connection](images/opcda_conn.png)

#### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| **Name** | –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. |
| **Period (ms)** | –ü–µ—Ä–∏–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (Update Rate –¥–ª—è –≥—Ä—É–ø–ø—ã OPC). |
| **Shutdown timeout** | –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞. |
| **Master connection** | –°—Å—ã–ª–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (–¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è). |
| **Support for group requests** | **Yes** ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º OPC Group –¥–ª—è –ø–∞–∫–µ—Ç–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è). |

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (TCP / DCOM)
–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –¥—Ä—É–≥–∏—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤, –∑–¥–µ—Å—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ —Ö–æ—Å—Ç, –≥–¥–µ –∑–∞–ø—É—â–µ–Ω OPC Server.

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| **IP/Hostname/Localhost** | –°–µ—Ç–µ–≤–æ–π –∞–¥—Ä–µ—Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞, –≥–¥–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω OPC-—Å–µ—Ä–≤–µ—Ä.<br>*–ü—Ä–∏–º–µ—Ä:* `192.168.1.5` –∏–ª–∏ `localhost` (–µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–∞ —Ç–æ–π –∂–µ –º–∞—à–∏–Ω–µ). |
| **Port** | **8100** (–∏–ª–∏ –¥—Ä—É–≥–æ–π –ø–æ—Ä—Ç, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ). <br>*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:* –í –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–º OPC DA –ø–æ—Ä—Ç TCP –∂–µ—Å—Ç–∫–æ –Ω–µ –∑–∞–¥–∞–µ—Ç—Å—è (—Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ DCOM/RPC, –ø–æ—Ä—Ç 135), –Ω–æ –≤ –¥–∞–Ω–Ω–æ–º –¥—Ä–∞–π–≤–µ—Ä–µ —ç—Ç–æ –ø–æ–ª–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö OPC-—Ç—É–Ω–Ω–µ–ª–µ–π –∏–ª–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –ø—Ä–æ–∫—Å–∏. |
| **ServerID** | **ProgID OPC-—Å–µ—Ä–≤–µ—Ä–∞.** –≠—Ç–æ —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ –ø–æ–ª–µ.<br>–û–Ω–æ —Ç–æ—á–Ω–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Ä–µ–µ—Å—Ç—Ä–µ Windows.<br>*–ü—Ä–∏–º–µ—Ä—ã:* `Kepware.KEPServerEX.V6`, `Matrikon.OPC.Simulation.1`, `ICONICS.SimulatorOPCDA.2`. |

---

## –®–ê–ì 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (Binding)

–í OPC DA –∞–¥—Ä–µ—Å–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ –∏–º–µ–Ω–∏ —Ç–µ–≥–∞ (Item ID).

![–ù–∞—Å—Ç—Ä–æ–π–∫–∞ OPC DA Binding](images/)

### 2.1 –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∏–≤—è–∑–∫–∏

| –ü–æ–ª–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| **Name** | –ò–º—è –ø—Ä–∏–≤—è–∑–∫–∏ –≤ –¥–µ—Ä–µ–≤–µ –ø—Ä–æ–µ–∫—Ç–∞. |
| **Title** | –ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ. |
| **Tag** | –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–∏—Å—Ç–µ–º–Ω—ã–π —Ç–µ–≥ Faceplate, –∫—É–¥–∞ –±—É–¥–µ—Ç —Ç—Ä–∞–Ω—Å–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ. |
| **Access** | **R** ‚Äî –ß—Ç–µ–Ω–∏–µ (Read), **W** ‚Äî –ó–∞–ø–∏—Å—å (Write), **RW** ‚Äî –ß—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å. |
| **Transformation** | *–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ.* –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—ã—Ä–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è. |

### 2.2 –ê–¥—Ä–µ—Å–∞—Ü–∏—è (OPC Tag)

| –ü–æ–ª–µ | –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è |
| :--- | :--- |
| **OPC tag** | **Item ID (–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞).**<br>–ü–æ–ª–Ω—ã–π –ø—É—Ç—å –∫ —Ç–µ–≥—É –≤ –∞–¥—Ä–µ—Å–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ OPC-—Å–µ—Ä–≤–µ—Ä–∞.<br>*–ü—Ä–∏–º–µ—Ä—ã:*<br>‚Ä¢ `Channel1.Device1.Tag1`<br>‚Ä¢ `Simulation.Ramp`<br>‚Ä¢ `Bucket Brigade.Int4` |

---

## üí° –ß–µ–∫-–ª–∏—Å—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (Troubleshooting)

1.  **ProgID (ServerID):** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–º—è —Å–µ—Ä–≤–µ—Ä–∞ –≤–≤–µ–¥–µ–Ω–æ –±–µ–∑ –æ—à–∏–±–æ–∫. –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ, —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö ProgID –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —É—Ç–∏–ª–∏—Ç–∞–º–∏ —Ç–∏–ø–∞ *OPC Explorer* –∏–ª–∏ *Matrikon OPC Explorer*.
2.  **DCOM Hell:** –ï—Å–ª–∏ `IP` —É–¥–∞–ª–µ–Ω–Ω—ã–π, –∞ —Å—Ç–∞—Ç—É—Å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è `Error`, –≤ 99% —Å–ª—É—á–∞–µ–≤ –ø—Ä–æ–±–ª–µ–º–∞ –≤ –ø—Ä–∞–≤–∞—Ö Windows.
    * –°–æ–∑–¥–∞–π—Ç–µ –Ω–∞ –æ–±–µ–∏—Ö –º–∞—à–∏–Ω–∞—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –ª–æ–≥–∏–Ω–æ–º –∏ –ø–∞—Ä–æ–ª–µ–º.
    * –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª—É–∂–±—ã Faceplate –æ—Ç –∏–º–µ–Ω–∏ —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    * –ù–∞—Å—Ç—Ä–æ–π—Ç–µ DCOM Config (`dcomcnfg`) –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, —Ä–∞–∑—Ä–µ—à–∏–≤ —É–¥–∞–ª–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø.
3.  **–°–∏–Ω—Ç–∞–∫—Å–∏—Å —Ç–µ–≥–æ–≤:** Item ID —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ —Ä–µ–≥–∏—Å—Ç—Ä—É (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞). –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—É—Ç—å –∫ —Ç–µ–≥—É –∏–∑ OPC-–∫–ª–∏–µ–Ω—Ç–∞, —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å –æ–ø–µ—á–∞—Ç–∫–∏.
4.  **–ö–∞—á–µ—Å—Ç–≤–æ (Quality):** –ï—Å–ª–∏ —Å–≤—è–∑—å –µ—Å—Ç—å (`State: RUN`), –Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–≥–∞ "–ø–ª–æ—Ö–æ–µ" –∏–ª–∏ `0`, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ç–µ–≥–∞ –Ω–∞ —Å–∞–º–æ–º OPC-—Å–µ—Ä–≤–µ—Ä–µ. –í–æ–∑–º–æ–∂–Ω–æ, —Å–µ—Ä–≤–µ—Ä –Ω–µ –≤–∏–¥–∏—Ç –ü–õ–ö.
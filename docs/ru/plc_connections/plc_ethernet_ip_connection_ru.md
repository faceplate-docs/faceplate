# Конфигурация драйвера Ethernet/IP (Rockwell Automation)

## Общее описание
Протокол **EtherNet/IP** (Industrial Protocol) — это промышленный стандарт, использующий Common Industrial Protocol (CIP) поверх стандартного Ethernet.
В системе **Faceplate** данный драйвер используется для нативной интеграции с контроллерами **Allen-Bradley (Rockwell Automation)** и совместимыми устройствами.

###  Поддерживаемое оборудование
Согласно конфигурации драйвера, поддерживаются следующие семейства контроллеров:
* **ControlLogix / CompactLogix** (Теговая адресация, CIP)
* **Micro800** (Серия Micro820/850/870)
* **MicroLogix** (PCCC адресация)
* **SLC 500** (Legacy, PCCC)
* **PLC-5** (Legacy, PCCC)
* **LogixPCCC** (Специфичный режим для Logix через PCCC)

Процесс настройки состоит из двух этапов:
1.  **Connection (`plc_ethernet_ip_connection`):** Настройка сетевого соединения протокола.
2.  **Binding (`plc_ethernet_ip_binding`):** Адресация конкретных информационных объектов и настройка привязки.

---

## 1. Настройка соединения (Connection)

На этом этапе создается сессия связи с контроллером.
> Создать PLC cоединения → [Шаги создания PLC соединения](./general_ru.md#создание-plc-соединения)

![Настройка соединения Ethernet/IP](images/eip_connection.png)

### 1.1 Панель диагностики
>Диагностика PLC соединения → [Диагностика](./general_ru.md#диагностика-diagnostics)

| Поле | Описание |
| :--- | :--- |
| **State** | **STOP** — драйвер остановлен.<br>**RUN** — драйвер запущен. |
| **Node** | Узел кластера. Указывает, на каком узле выполняется процесс. |
| **PID** | ID процесса. |
| **Error** | Текст ошибки (при наличии). |
| **Disabled** | Флаг отключения соединения. Через данную кнопку пользователь отключает или включает драйвер.|
| **Memory limit (bytes)** | Ограничение памяти (пределы оперативной памяти в байтах для процесса, обслуживающего соединение). Емкость памяти определяет количество переменных (тегов), которые могут быть обработаны. |
| **Actual connection** | Текущий активный канал связи. В системах с резервированием (Redundancy) указывает, какое именно соединение (основное или резервное) осуществляет обмен данными в текущий момент. |
| **Master connection** | Привязка к основному каналу связи. Заполняется для резервных соединений. Поле указывает, какое соединение является приоритетным (Master), определяя логическую пару для механизма резервирования. |

### 1.1 Основные параметры (General Settings)

| Параметр | Описание |
| :--- | :--- |
| **Name** | Уникальное системное имя соединения. |
| **Title** | Заголовок (описание) данного объекта. |
| **Period (ms)** | Период опроса. <br>*Рекомендация:* Для Ethernet/IP обычно 100-500 мс. CIP — быстрый протокол, но не перегружайте EN2T модули. |
| **Shutdown timeout** | Время ожидания корректного разрыва TCP-сессии (CIP Forward Close). |
| **Master connection** | Используется для настройки резервирования (Redundancy). Ссылка на основной канал. |
| **Support for group requests** | **Yes** — включить оптимизацию (Multi-Request packets). Драйвер будет упаковывать несколько чтений в один Ethernet-кадр. |

### 1.2 Параметры контроллера (Controller Settings)

Это критически важная секция, определяющая метод адресации.

![Типы контроллеров](images/plc_type.png)

| Поле | Описание и аналитика |
| :--- | :--- |
| **Тип контроллера** | Выберите семейство ПЛК:<br>• **ControlLogix:** Использует символьные имена тегов. Самый современный режим.<br>• **MicroLogix / SLC / PLC5:** Используют адресацию файлов данных (N7:0, F8:1). |
| **IP** | IP-адрес коммуникационного модуля или процессора. |
| **Routing** | *Опционально.* Путь CIP (CIP Path) для доступа к процессору, если он находится не в том же слоте, куда приходит Ethernet, или в другом шасси.<br>*Формат:* Обычно указывается как последовательность пар `Порт,Адрес`.<br>*Пример:* `1,0` (Backplane, Slot 0). Оставьте пустым для CompactLogix (без шасси). |

---

##  2. Настройка переменных (Binding)

В протоколе Ethernet/IP (особенно для ControlLogix) мы обращаемся к данным по **Имени тега**, а не по адресу памяти.

![Настройка привязки тега](images/eip_bindings.png)
> Создать PLC привязку → [Шаги создания PLC привязки](./general_ru.md#создание-plc-привязки)


### 2.1 Параметры привязки

| Поле | Описание |
| :--- | :--- |
| **Name** | Имя объекта привязки в дереве системы. |
| **Title** | Заголовок (описание) для данного объекта. |
| **State** | **STOP** — привязка остановлена.<br>**RUN** — привязка запущен. |
| **Tag** | Системный тег Faceplate. Приходящее значение будет записано в выбранное поле выбранного объекта. Cм. [Привязка к тегу](./general_ru.md#привязка-к-тегу-на-примере-архива) |
| **Access** | **R** (Чтение), **W** (Запись), **RW** (Чтение/Запись).|
| **Transformation** |  Преобразование значения. См. [Transformation](./transformation_ru.md). |

### 2.2 Адресация данных (Target Data)

| Поле | Инструкция по заполнению |
| :--- | :--- |
| **Controller tag name** | **Символьный адрес в ПЛК.**<br>• Для **ControlLogix:** Имя тега, как в Studio 5000. Например: `MyTag`, `Program:MainProg.Step`.<br>• Для **SLC/MicroLogix:** Адрес элемента. Например: `N7:0`, `F8:10`, `B3:0/5`. |
| **Data type** | Тип данных, ожидаемый от контроллера (BOOL, SINT, LREAL, USINT, INT, UINT, DINT, UDINT, LINT, LINT, ULINT, REAL). Должен совпадать с типом, объявленным в PLC. |

>Ошибка в PLC привязке -> [ошибка привязки](./general_ru.md#ошибка-в-привязке)
---

